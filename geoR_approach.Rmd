---
title: "FWSW_Proj"
author: "Mikala"
date: "March 21, 2016"
output: word_document
---


```{r}
# First, the data file is imported, and the relevant columns of data are subsetted from the data file.
park = ParkQuant
colsofinterest = c('Utm_E', 'Utm_N', 'Chloride')
parka <- subset(park, select = colsofinterest)

# The necessary packages are loaded from R
library(geoR)
library(gstat)

# The subsetted data is converted to geodata
parkb <- as.geodata(parka)

# A predictive model is created to predict a specific chloride value based on a given new location
prediction <- ksline(parkb, cov.model="exp", cov.pars=c(10, 3.33),                        nugget=0, locations=c(332640,795600))
prediction$predict

# Produce a grid whose points will be estimated using kriging
x.range <- as.integer(range(park[,1]))
y.range <- as.integer(range(park[,2]))
x=seq(from=x.range[1], to=x.range[2], by=100)
y=seq(from=y.range[1], to=y.range[2], by=100)
length(x)
length(y)
xv <- rep(x,length(y))
yv <- rep(y, each=length(x))
in_mat <- as.matrix(cbind(xv,yv))
plot(in_mat)

# Predicts the value at each one of these points
q <- ksline(parkb, cov.model="exp",cov.pars=c(10,3.33), nugget=0,
       locations=in_mat)

# Construct the raster map
image(q, val=q$predict)
points(parka)

# Access the predicted values and their variances (for first 5 values)
cbind(q$predict[1:5], q$krige.var[1:5])

# Construct a perspective plot of the predicted values
zmatrix <- matrix(q$predict, 1274, 966)
persp(x,y,zmatrix, xlab="x coordinate",
  ylab="y coordinate", zlab="Predicted values of z",
  main="Perspective plot of the predicted values")

# Construct a perspective plot of the standard errors
zmatrix2 <- matrix(q$krige.var, 1274, 966)
persp(x,y,zmatrix2, xlab="x coordinate",
  ylab="ycoordinate", zlab="Predicted values of z",
  main="Perspective plot of the standard errors")


```


